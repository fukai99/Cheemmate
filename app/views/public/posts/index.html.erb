<%#= render partial: 'user_info', locals: { user: user } %>

<div class="col-xs-2">
  <table class="table table-hover table-bordered">
    <thead>
    <tr>
      <th>ジャンル検索</th>
    </tr>
    </thead>
    <tbody>
      <% @genres.each do |genre| %>
        <tr>
          <!--(パラメータ名: 取得したい値=URLの?以降に表示される)-->
          <td><%= link_to genre.name, posts_path(genre_id: genre.id) %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>


<h1>投稿一覧</h1>
<% @posts.each do |post| %>

  <p>投稿日時: <%= post.created_at.strftime("%Y-%m-%d %H:%M:%S") %></p>


    <%= image_tag post.user.get_avatar(70,70) %>


  <p>ユーザーネーム<%= link_to post.user.disply_name, user_path(post.user) %></p>

  <p>属柄:<%= post.user.family_relationship %></p>


  <p>ジャンル名:<%= post.genre.name %></p>


  <p>コメント<%= post.content %></p><br>

  <% if post.images.attached? %>
    <% post.images.each do |image| %>
      <%= image_tag image, size: "150x150" %>
    <% end %>
  <% end %><br>

  <% post.youtube_urls.each do |youtube_url| %>
      <iframe width="224" height="126" src="https://www.youtube.com/embed/<%= youtube_url.path %>" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><br>
    <% end %>

    <% if post.favorited_by?(current_user) %>
    <p>
      <%= link_to post_favorites_path(post), method: :delete do %>
        <i class="fas fa-heart" style="color: #eca7df;"></i>
        <%= post.favorites.count %> 
      <% end %>
    </p>
    <% else %>
    <p>
      <%= link_to post_favorites_path(post), method: :post do %>
        <i class="far fa-heart" style="color: #eca7df;"></i>
        <%= post.favorites.count %>
      <% end %>
    </p>
  <% end %>

  <% if post.bookmarked_by?(current_user) %>
    <p>
      <%= link_to post_bookmarks_path(post), method: :delete do %>
        <i class="fas fa-bookmark" style="color: #5884d0;"></i>
      <% end %>
    </p>
    <% else %>
    <p>
      <%= link_to post_bookmarks_path(post), method: :post do %>
        <i class="far fa-bookmark" style="color: #5884d0;"></i>
      <% end %>
    </p>
  <% end %>

  <% if current_user.commented_on?(post) %>
  <p><i class="fas fa-comment" style="color: #48350e;"></i><%= link_to post.comments.count, post_path(post) %></p>
<% else %>
  <p><i class="far fa-comment" style="color: #48350e;"></i><%= link_to post.comments.count, post_path(post) %></p>
<% end %>

  <% if current_user == post.user %>
    <%= link_to "編集", edit_post_path(post) %>
    <%= link_to "削除", post_path(post), method: :delete, data: { confirm: "削除しますか？" } %>
  <% else %>
    <%= link_to "コメントする", post_path(post.id) %>
  <% end %><br>
<% end %>
